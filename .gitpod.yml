# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

tasks:
  - name: Apt install
    command: |
      sudo apt update
      sudo apt install --no-install-recommends -y \
        ipython3 python3-setuptools python3-venv python3-dev \
        texlive-xetex gettext libjs-bootstrap4 fonts-font-awesome git
      gp sync-done apt
  - name : Install requirements
    init : gp sync-await apt
    command: |
      pip3 install -r requirements.txt
      gp sync-done pip
  - name : Setup env
    command: cp .env_example .env
  - name: Django Init
    init : gp sync-await pip
    command: |
      python3 manage.py collectstatic --noinput
      python3 manage.py compilemessages
      python3 manage.py makemigrations
      python3 manage.py migrate
      python3 manage.py loaddata initial
      python3 manage.py shell -c "from django.contrib.auth.models import User; User.objects.create_superuser('admin', 'admin@example.com', 'adminpass')"
      gp sync-done django
  
  - name: Django start server
    init : gp sync-await django
    command: python3 manage.py runserver 0.0.0.0:8000
ports:
  - name: Web Dev Server
    port: 8000
    visibility: public
  
  


